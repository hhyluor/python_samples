# -*- coding: utf-8 -*-
# @Time : 2023/3/18 12:02
# @Author : hehaiyang
# @File : openai_api_try.py
# @Project : python_samples
# @Function :
# Note: you need to be using OpenAI Python v0.27.0 for the code below to work
import openai

# 用您的API密钥替换此处的YOUR_API_KEY
from OpenAI_samples.settings import hy_api_key

openai.api_key = hy_api_key
ss = "\u6807\u7b7e\u7f16\u7801|\u6807\u7b7e|\u5bf9\u5916\u663e\u793a\u6807\u7b7e\u7f16\u7801|\u5bf9\u5916\u663e\u793a\u6807\u7b7e|\u533b\u5b66\u4e34\u5e8a\u610f\u4e49|\u533b\u5b66\u5efa\u8bae\nI73.902R|\u53f3\u8ddb\u884c|I73.902|\u8ddb\u884c|\u8ddb\u884c\u662f\u56e0\u4e3a\u81c0\u808c\u5931\u53bb\u4e86\u529b\u91cf\uff0c\u53ef\u80fd\u662f\u8111\u4f9b\u8840\u4e0d\u8db3\u5bfc\u81f4\u7684\uff0c\u9700\u8981\u8fdb\u884c\u76f8\u5173\u68c0\u67e5\uff0c\u6bd4\u5982\u9888\u90e8\u8840\u7ba1\u8d85\u58f0\u7b49\u3002\u5efa\u8bae\u8fdb\u884c\u9002\u5f53\u7684\u5eb7\u590d\u953b\u70bc\u3002\nI73.902L|\u5de6\u8ddb\u884c|I73.902|\u8ddb\u884c|\u8ddb\u884c\u662f\u56e0\u4e3a\u81c0\u808c\u5931\u53bb\u4e86\u529b\u91cf\uff0c\u53ef\u80fd\u662f\u8111\u4f9b\u8840\u4e0d\u8db3\u5bfc\u81f4\u7684\uff0c\u9700\u8981\u8fdb\u884c\u76f8\u5173\u68c0\u67e5\uff0c\u6bd4\u5982\u9888\u90e8\u8840\u7ba1\u8d85\u58f0\u7b49\u3002\u5efa\u8bae\u8fdb\u884c\u9002\u5f53\u7684\u5eb7\u590d\u953b\u70bc\u3002\nZ46.3511|\u4e0d\u826f\u4fee\u590d\u4f53|Z46.3511|\u4e0d\u826f\u4fee\u590d\u4f53|\u4e0d\u826f\u4fee\u590d\u4f53\u662f\u6307\u4e4b\u524d\u7684\u624b\u672f\u6216\u4fee\u590d\u5e76\u6ca1\u6709\u8fbe\u5230\u9884\u671f\u6548\u679c\u5bfc\u81f4\u7684\u5e76\u53d1\u75c7\u3002\u5efa\u8bae\u53ca\u65f6\u54a8\u8be2\u5916\u79d1\u533b\u751f\u8fdb\u884c\u91cd\u65b0\u6cbb\u7597\u3002\nL05.900x001|\u85cf\u6bdb\u56ca\u80bf|L05.900x001|\u85cf\u6bdb\u56ca\u80bf|\u85cf\u6bdb\u56ca\u80bf\u662f\u76ae\u80a4\u7ec4\u7ec7\u5185\u7684\u5c0f\u56ca\u80bf\uff0c\u591a\u6570\u60c5\u51b5\u4e0b\u9700\u8981\u624b\u672f\u6cbb\u7597\u3002\u5efa\u8bae\u53ca\u65f6\u5c31\u8bca\u3002\nC21.850|\u80a0\u58c1\u589e\u539a|C21.850|\u80a0\u58c1\u589e\u539a|\u80a0\u58c1\u589e\u539a\u53ef\u80fd\u662f\u56e0\u4e3a\u80a0\u9053\u611f\u67d3\u3001\u6d88\u5316\u4e0d\u826f\u7b49\u539f\u56e0\u5f15\u8d77\u7684\uff0c\u5728\u6cbb\u7597\u4e0a\u9700\u6839\u636e\u75c5\u56e0\u8fdb\u884c\u76f8\u5e94\u7684\u6cbb\u7597\u63aa\u65bd\uff0c\u5efa\u8bae\u53ca\u65f6\u5c31\u8bca\u3002\nS53.302R|\u53f3\u5c3a\u4fa7\u526f\u97e7\u5e26\u635f\u4f24|S53.3020|\u5c3a\u4fa7\u526f\u97e7\u5e26\u635f\u4f24\uff08\u53ef\u80fd\uff09|\u5c3a\u4fa7\u526f\u97e7\u5e26\u635f\u4f24\u662f\u6307\u624b\u8155\u5173\u8282\u53d7\u5230\u5916\u529b\u649e\u51fb\u6216\u626d\u8f6c\u65f6\u5bfc\u81f4\u7684\u97e7\u5e26\u635f\u4f24\uff0c\u9700\u91c7\u53d6\u9002\u5f53\u7684\u56fa\u5b9a\u63aa\u65bd\uff0c\u5efa\u8bae\u53ca\u65f6\u5c31\u8bca\u5e76\u8fdb\u884c\u5eb7\u590d\u6cbb\u7597\u3002\nZ46.3512|\u5145\u586b\u4f53\u8131\u843d|Z46.3512|\u5145\u586b\u4f53\u8131\u843d|\u5145\u586b\u4f53\u8131\u843d\u662f\u6307\u4e4b\u524d\u7684\u624b\u672f\u6216\u4fee\u590d\u4e2d\u4f7f\u7528\u7684\u5145\u586b\u4f53\u6750\u6599\u8131\u843d\u6216\u8131\u843d\u4e0d\u5b8c\u5168\uff0c\u9700\u8981\u8fdb\u884c\u518d\u6b21\u624b\u672f\u6216\u4fee\u590d\uff0c\u5efa\u8bae\u53ca\u65f6\u54a8\u8be2\u5916\u79d1\u533b\u751f\u8fdb\u884c\u6cbb\u7597\u3002",


def generate_markdown(prompt):
    response = openai.ChatCompletion.create(
        model="gpt-3.5-turbo-0301",
        messages=[
            {"role": "system", "content": "you are a doctor."},
            {"role": "user", "content": prompt},
        ],
    )
    print(response)
    return response.choices[0].text.strip()


if __name__ == "__main__":
    prompt = """
请帮我在标签四元组后面加上一列对应的医学临床意义，一列对应的医学建议
标签编码|标签|对外显示标签编码|对外显示标签
I73.902R|右跛行|I73.902|跛行
I73.902L|左跛行|I73.902|跛行
Z46.3511|不良修复体|Z46.3511|不良修复体
L05.900x001|藏毛囊肿|L05.900x001|藏毛囊肿
C21.850|肠壁增厚|C21.850|肠壁增厚
S53.302R|右尺侧副韧带损伤|S53.3020|尺侧副韧带损伤（可能）
Z46.3512|充填体脱落|Z46.3512|充填体脱落
    """
    # markdown_text = generate_markdown(prompt)

    # with open("markdown_output.md", "w") as md_file:
    #     md_file.write(markdown_text)
    #
    # print("Markdown文档已生成并保存为markdown_output.md")
